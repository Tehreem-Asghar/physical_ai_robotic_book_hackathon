---
sidebar_position: 4
---

# Building ROS 2 Packages

## Overview
This chapter covers the process of creating and building your own ROS 2 packages. A package is the fundamental unit of software organization in ROS 2. Learning to create packages is essential for structuring your code, managing dependencies, and sharing your work with others.

## Learning Outcomes
- Understand the structure of a ROS 2 package.
- Use `ros2 pkg create` to generate a new package skeleton.
- Understand the role of `package.xml` and `CMakeLists.txt` (for C++) or `setup.py` (for Python).
- Build a package using `colcon build`.
- Source the workspace to make the new package available to ROS 2.

## Real-life example
When you download a ROS 2 driver for a new camera or a navigation algorithm from GitHub, you are downloading a ROS 2 package (or a set of packages). You then place this code in your workspace, build it with `colcon`, and source the environment to use its functionality in your project.

## Technical explanation with diagrams
A ROS 2 workspace is a directory containing one or more packages. The build tool, `colcon`, compiles the packages and installs the executables and libraries into an `install` directory.

```mermaid
graph TD
    subgraph ROS 2 Workspace ("~/ros2_ws")
        direction LR
        A[src] --> B(package_a)
        A --> C(package_b)
    end
    
    A -- "Code lives here" --> D{colcon build}
    
    subgraph Build Process
        D
    end
    
    D -- "Generates" --> E[build]
    D -- "Generates" --> F[install]
    D -- "Generates" --> G[log]

    H(source install/setup.bash) -- "Enables" --> I(ros2 run package_a node_name)

```
*Figure 1: The typical ROS 2 workspace and build process.*

## Code examples (Shell/Terminal)
```bash
# Placeholder for terminal commands to create and build a package

# 1. Navigate to your workspace's src directory
cd ~/ros2_ws/src

# 2. Create a new Python package
ros2 pkg create --build-type ament_python --node-name my_node my_python_pkg

# The command above creates a directory 'my_python_pkg' with the following files:
# - my_python_pkg/
#   - __init__.py
#   - my_node.py
# - resource/
#   - my_python_pkg
# - test/
#   - test_copyright.py
#   - ...
# - package.xml
# - setup.cfg
# - setup.py

# 3. Go back to the root of the workspace
cd ~/ros2_ws

# 4. Build the package
colcon build --packages-select my_python_pkg

# 5. Source the new environment
source install/setup.bash

# 6. Run your new node
ros2 run my_python_pkg my_node
```

## Glossary
- **Package**: The main unit of software organization in ROS 2. It contains nodes, libraries, configuration files, and a `package.xml` to describe it.
- **Workspace**: A directory containing ROS 2 packages, typically with `src`, `build`, `install`, and `log` subdirectories.
- **colcon**: The standard command-line tool to build ROS 2 packages.
- **package.xml**: An XML file in a package that defines its properties, such as its name, version, author, and dependencies.
- **ament**: The build system used by ROS 2. `ament_python` and `ament_cmake` are specific types for Python and C++ packages.

## Quiz Questions
1. What command is used to build a ROS 2 workspace?
    a) `ros2 build`
    b) `make`
    c) `catkin_make`
    d) `colcon build`

2. What is the purpose of the `package.xml` file?
    a) To store the main source code for nodes.
    b) To define metadata and dependencies for the package.
    c) To configure the text editor.
    d) It is a log file generated by the build process.

3. After building a new package, what crucial step must you take before you can use `ros2 run` to execute its nodes?

4. What is the difference between the `src` and `install` directories in a ROS 2 workspace?

5. What does the `--build-type ament_python` option specify when creating a package?
